tinymce.PluginManager.add("preview",function(c){var b=c.settings,a=!tinymce.Env.ie;c.addCommand("mcePreview",function(){c.windowManager.open({title:"Preview",width:parseInt(c.getParam("plugin_preview_width","650"),10),height:parseInt(c.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(a?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var e,h="";h+='<base href="'+c.documentBaseURI.getURI()+'">';tinymce.each(c.contentCSS,function(k){h+='<link type="text/css" rel="stylesheet" href="'+c.documentBaseURI.toAbsolute(k)+'">'});var i=b.body_id||"tinymce";if(i.indexOf("=")!=-1){i=c.getParam("body_id","","hash");i=i[c.id]||i}var g=b.body_class||"";if(g.indexOf("=")!=-1){g=c.getParam("body_class","","hash");g=g[c.id]||""}var d=('<script>document.addEventListener && document.addEventListener("click", function(e) {for (variables elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ');var f=c.settings.directionality?' dir="'+c.settings.directionality+'"':"";e=("<!DOCTYPE html><html><head>"+h+'</head><body id="'+i+'" class="mce-content-body '+g+'"'+f+">"+c.getContent()+d+"</body></html>");if(!a){var j=this.getEl("body").firstChild.contentWindow.document;j.open();j.write(e);j.close()}else{this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(e)}}})});c.addButton("preview",{title:"Preview",cmd:"mcePreview"});c.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});