define("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/dom/TreeWalker","tinymce/dom/NodePath","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/util/Delay","tinymce/caret/CaretContainer","tinymce/caret/CaretPosition","tinymce/caret/CaretWalker"],function(l,f,k,d,g,b,h,c,a,j,e,i){return function(m){var af=c.each,S=m.$;var o=l.BACKSPACE,A=l.DELETE,n=m.dom,D=m.selection,aj=m.settings,R=m.parser,I=m.serializer;var q=h.gecko,y=h.ie,ac=h.webkit;var X="data:text/mce-internal,";var p=y?"Text":"URL";function W(aq,ap){try{m.getDoc().execCommand(aq,false,ap)}catch(ao){}}function F(){var ao=m.getDoc().documentMode;return ao?ao:6}function V(ao){return ao.isDefaultPrevented()}function an(ap){var ao,aq;if(ap.dataTransfer){if(m.selection.isCollapsed()&&ap.target.tagName=="IMG"){D.select(ap.target)}ao=m.selection.getContent();if(ao.length>0){aq=X+escape(m.id)+","+escape(ao);ap.dataTransfer.setData(p,aq)}}}function G(ao){var ap;if(ao.dataTransfer){ap=ao.dataTransfer.getData(p);if(ap&&ap.indexOf(X)>=0){ap=ap.substr(X.length).split(",");return{id:unescape(ap[0]),html:unescape(ap[1])}}}return null}function M(ao){if(m.queryCommandSupported("mceInsertClipboardContent")){m.execCommand("mceInsertClipboardContent",false,{content:ao})}else{m.execCommand("mceInsertContent",false,ao)}}function al(){var aA=m.getDoc(),au=m.dom,aB=m.selection;var ap=window.MutationObserver,av,az;if(!ap){av=true;ap=function(){var aD=[],aG;function aF(aI){var aH=aI.relatedNode||aI.target;aD.push({target:aH,addedNodes:[aH]})}function aE(aI){var aH=aI.relatedNode||aI.target;aD.push({target:aH,attributeName:aI.attrName})}this.observe=function(aH){aG=aH;aG.addEventListener("DOMSubtreeModified",aF,false);aG.addEventListener("DOMNodeInsertedIntoDocument",aF,false);aG.addEventListener("DOMNodeInserted",aF,false);aG.addEventListener("DOMAttrModified",aE,false)};this.disconnect=function(){aG.removeEventListener("DOMSubtreeModified",aF,false);aG.removeEventListener("DOMNodeInsertedIntoDocument",aF,false);aG.removeEventListener("DOMNodeInserted",aF,false);aG.removeEventListener("DOMAttrModified",aE,false)};this.takeRecords=function(){return aD}}}function ao(aF){var aE=au.schema.getBlockElements(),aD=m.getBody();if(aF.nodeName!="BR"){return false}for(;aF!=aD&&!aE[aF.nodeName];aF=aF.parentNode){if(aF.nextSibling){return false}}return true}function aq(aE,aD){var aF;for(aF=aE.nextSibling;aF&&aF!=aD;aF=aF.nextSibling){if(aF.nodeType==3&&S.trim(aF.data).length===0){continue}if(aF!==aD){return false}}return aF===aD}function aw(aG,aF,aE){var aI,aH,aD;aD=au.schema.getNonEmptyElements();aI=new k(aE||aG,aG);while((aH=aI[aF?"next":"prev"]())){if(aD[aH.nodeName]&&!ao(aH)){return aH}if(aH.nodeType==3&&aH.data.length>0){return aH}}}function ay(aE){var aH,aF,aD,aG,aI;if(aE.collapsed){return}aH=au.getParent(f.getNode(aE.startContainer,aE.startOffset),au.isBlock);aF=au.getParent(f.getNode(aE.endContainer,aE.endOffset),au.isBlock);aI=m.schema.getTextBlockElements();if(aH==aF){return}if(!aI[aH.nodeName]||!aI[aF.nodeName]){return}if(au.getContentEditable(aH)==="false"||au.getContentEditable(aF)==="false"){return}aE.deleteContents();aD=aw(aH,false);aG=aw(aF,true);if(!au.isEmpty(aF)){S(aH).append(aF.childNodes)}S(aF).remove();if(aD){if(aD.nodeType==1){if(aD.nodeName=="BR"){aE.setStartBefore(aD);aE.setEndBefore(aD)}else{aE.setStartAfter(aD);aE.setEndAfter(aD)}}else{aE.setStart(aD,aD.data.length);aE.setEnd(aD,aD.data.length)}}else{if(aG){if(aG.nodeType==1){aE.setStartBefore(aG);aE.setEndBefore(aG)}else{aE.setStart(aG,0);aE.setEnd(aG,0)}}}aB.setRng(aE);return true}function at(aE,aJ){var aG,aI,aF,aH,aD,aK;if(!aE.collapsed){return aE}aD=aE.startContainer;aK=aE.startOffset;if(aD.nodeType==3){if(aJ){if(aK<aD.data.length){return aE}}else{if(aK>0){return aE}}}aG=f.getNode(aE.startContainer,aE.startOffset);aF=au.getParent(aG,au.isBlock);aI=aw(m.getBody(),aJ,aG);aH=au.getParent(aI,au.isBlock);if(!aG||!aI){return aE}if(aH&&aF!=aH){if(!aJ){if(!aq(aH,aF)){return aE}if(aI.nodeType==1){if(aI.nodeName=="BR"){aE.setStartBefore(aI)}else{aE.setStartAfter(aI)}}else{aE.setStart(aI,aI.data.length)}if(aG.nodeType==1){aE.setEnd(aG,0)}else{aE.setEndBefore(aG)}}else{if(!aq(aF,aH)){return aE}if(aG.nodeType==1){if(aG.nodeName=="BR"){aE.setStartBefore(aG)}else{aE.setStartAfter(aG)}}else{aE.setStart(aG,aG.data.length)}if(aI.nodeType==1){aE.setEnd(aI,0)}else{aE.setEndBefore(aI)}}}return aE}function ar(aE){var aD=aB.getRng();aD=at(aD,aE);if(ay(aD)){return true}}function aC(aO,aD){var aP,aG,aH,aI,aL,aE,aK,aN,aF;function aJ(aR,aQ){aF=S(aQ).parents().filter(function(aS,aT){return !!m.schema.getTextInlineElements()[aT.nodeName]});aH=aR.cloneNode(false);aF=c.map(aF,function(aS){aS=aS.cloneNode(false);if(aH.hasChildNodes()){aS.appendChild(aH.firstChild);aH.appendChild(aS)}else{aH.appendChild(aS)}aH.appendChild(aS);return aS});if(aF.length){aN=au.create("br");aF[0].appendChild(aN);au.replace(aH,aR);aD.setStartBefore(aN);aD.setEndBefore(aN);m.selection.setRng(aD);return aN}return null}function aM(aQ){return aQ&&m.schema.getTextBlockElements()[aQ.tagName]}if(!aD.collapsed){return}aE=aD.startContainer;aK=aD.startOffset;aG=au.getParent(aE,au.isBlock);if(!aM(aG)){return}if(aE.nodeType==1){aE=aE.childNodes[aK];if(aE&&aE.tagName!="BR"){return}if(aO){aL=aG.nextSibling}else{aL=aG.previousSibling}if(au.isEmpty(aG)&&aM(aL)&&au.isEmpty(aL)){if(aJ(aG,aE)){au.remove(aL);return true}}}else{if(aE.nodeType==3){aP=d.create(aG,aE);aI=aG.cloneNode(true);aE=d.resolve(aI,aP);if(aO){if(aK>=aE.data.length){return}aE.deleteData(aK,1)}else{if(aK<=0){return}aE.deleteData(aK-1,1)}if(au.isEmpty(aI)){return aJ(aG,aE)}}}}function ax(aF){var aE,aD,aG;if(ar(aF)){return}c.each(m.getBody().getElementsByTagName("*"),function(aH){if(aH.tagName=="SPAN"){aH.setAttribute("mce-data-marked",1)}if(!aH.hasAttribute("data-mce-style")&&aH.hasAttribute("style")){m.dom.setAttrib(aH,"style",m.dom.getAttrib(aH,"style"))}});aE=new ap(function(){});aE.observe(m.getDoc(),{childList:true,attributes:true,subtree:true,attributeFilter:["style"]});m.getDoc().execCommand(aF?"ForwardDelete":"Delete",false,null);aD=m.selection.getRng();aG=aD.startContainer.parentNode;c.each(aE.takeRecords(),function(aH){if(!au.isChildOf(aH.target,m.getBody())){return}if(aH.attributeName=="style"){var aI=aH.target.getAttribute("data-mce-style");if(aI){aH.target.setAttribute("style",aI)}else{aH.target.removeAttribute("style")}}c.each(aH.addedNodes,function(aK){if(aK.nodeName=="SPAN"&&!aK.getAttribute("mce-data-marked")){var aL,aJ;if(aK==aG){aL=aD.startOffset;aJ=aK.firstChild}au.remove(aK,true);if(aJ){aD.setStart(aJ,aL);aD.setEnd(aJ,aL);m.selection.setRng(aD)}}})});aE.disconnect();c.each(m.dom.select("span[mce-data-marked]"),function(aH){aH.removeAttribute("mce-data-marked")})}m.on("keydown",function(aH){var aG=aH.keyCode==A,aD=aH.ctrlKey||aH.metaKey;if(!V(aH)&&(aG||aH.keyCode==o)){var aF=m.selection.getRng(),aE=aF.startContainer,aI=aF.startOffset;if(aG&&aH.shiftKey){return}if(aC(aG,aF)){aH.preventDefault();return}if(!aD&&aF.collapsed&&aE.nodeType==3){if(aG?aI<aE.data.length:aI>0){return}}aH.preventDefault();if(aD){m.selection.getSel().modify("extend",aG?"forward":"backward",aH.metaKey?"lineboundary":"word")}ax(aG)}});m.on("keypress",function(aI){if(!V(aI)&&!aB.isCollapsed()&&aI.charCode>31&&!l.metaKeyPressed(aI)){var aD,aJ,aH,aE,aF,aG;aD=m.selection.getRng();aG=String.fromCharCode(aI.charCode);aI.preventDefault();aJ=S(aD.startContainer).parents().filter(function(aK,aL){return !!m.schema.getTextInlineElements()[aL.nodeName]});ax(true);aJ=aJ.filter(function(aK,aL){return !S.contains(m.getBody(),aL)});if(aJ.length){aH=au.createFragment();aJ.each(function(aK,aL){aL=aL.cloneNode(false);if(aH.hasChildNodes()){aL.appendChild(aH.firstChild);aH.appendChild(aL)}else{aF=aL;aH.appendChild(aL)}aH.appendChild(aL)});aF.appendChild(m.getDoc().createTextNode(aG));aE=au.getParent(aD.startContainer,au.isBlock);if(au.isEmpty(aE)){S(aE).empty().append(aH)}else{aD.insertNode(aH)}aD.setStart(aF.firstChild,1);aD.setEnd(aF.firstChild,1);m.selection.setRng(aD)}else{m.selection.setContent(aG)}}});m.addCommand("Delete",function(){ax()});m.addCommand("ForwardDelete",function(){ax(true)});if(av){return}m.on("dragstart",function(aD){az=aB.getRng();an(aD)});m.on("drop",function(aD){if(!V(aD)){var aE=G(aD);if(aE){aD.preventDefault();a.setEditorTimeout(m,function(){var aF=f.getCaretRangeFromPoint(aD.x,aD.y,aA);if(az){aB.setRng(az);az=null}ax();aB.setRng(aF);M(aE.html)})}}});m.on("cut",function(aD){if(!V(aD)&&aD.clipboardData&&!m.selection.isCollapsed()){aD.preventDefault();aD.clipboardData.clearData();aD.clipboardData.setData("text/html",m.selection.getContent());aD.clipboardData.setData("text/plain",m.selection.getContent({format:"text"}));a.setEditorTimeout(m,function(){ax(true)})}})}function L(){function ao(ar){var aq=n.create("body");var at=ar.cloneContents();aq.appendChild(at);return D.serializer.serialize(aq,{format:"html"})}function ap(aq){if(!aq.setStart){if(aq.item){return false}var av=aq.duplicate();av.moveToElementText(m.getBody());return f.compareRanges(aq,av)}var at=ao(aq);var au=n.createRng();au.selectNode(m.getBody());var ar=ao(au);return at===ar}m.on("keydown",function(au){var at=au.keyCode,ar,aq;if(!V(au)&&(at==A||at==o)){ar=m.selection.isCollapsed();aq=m.getBody();if(ar&&!n.isEmpty(aq)){return}if(!ar&&!ap(m.selection.getRng())){return}au.preventDefault();m.setContent("");if(aq.firstChild&&n.isBlock(aq.firstChild)){m.selection.setCursorLocation(aq.firstChild,0)}else{m.selection.setCursorLocation(aq,0)}m.nodeChanged()}})}function ak(){m.shortcuts.add("meta+a",null,"SelectAll")}function am(){if(!m.settings.content_editable){n.bind(m.getDoc(),"mousedown mouseup",function(ap){var ao;if(ap.target==m.getDoc().documentElement){ao=D.getRng();m.getBody().focus();if(ap.type=="mousedown"){if(j.isCaretContainer(ao.startContainer)){return}D.placeCaretAt(ap.clientX,ap.clientY)}else{D.setRng(ao)}}})}}function Z(){m.on("keydown",function(aq){if(!V(aq)&&aq.keyCode===o){if(!m.getBody().getElementsByTagName("hr").length){return}if(D.isCollapsed()&&D.getRng(true).startOffset===0){var ap=D.getNode();var ao=ap.previousSibling;if(ap.nodeName=="HR"){n.remove(ap);aq.preventDefault();return}if(ao&&ao.nodeName&&ao.nodeName.toLowerCase()==="hr"){n.remove(ao);aq.preventDefault()}}}})}function U(){if(!window.Range.prototype.getClientRects){m.on("mousedown",function(ap){if(!V(ap)&&ap.target.nodeName==="HTML"){var ao=m.getBody();ao.blur();a.setEditorTimeout(m,function(){ao.focus()})}})}}function t(){m.on("click",function(ap){var ao=ap.target;if(/^(IMG|HR)$/.test(ao.nodeName)&&n.getContentEditableParent(ao)!=="false"){ap.preventDefault();D.getSel().setBaseAndExtent(ao,0,ao,1);m.nodeChanged()}if(ao.nodeName=="A"&&n.hasClass(ao,"mce-item-anchor")){ap.preventDefault();D.select(ao)}})}function ag(){function ap(){var aq=n.getAttribs(D.getStart().cloneNode(false));return function(){var ar=D.getStart();if(ar!==m.getBody()){n.setAttrib(ar,"style",null);af(aq,function(at){ar.setAttributeNode(at.cloneNode(true))})}}}function ao(){return !D.isCollapsed()&&n.getParent(D.getStart(),n.isBlock)!=n.getParent(D.getEnd(),n.isBlock)}m.on("keypress",function(ar){var aq;if(!V(ar)&&(ar.keyCode==8||ar.keyCode==46)&&ao()){aq=ap();m.getDoc().execCommand("delete",false,null);aq();ar.preventDefault();return false}});n.bind(m.getDoc(),"cut",function(ar){var aq;if(!V(ar)&&ao()){aq=ap();a.setEditorTimeout(m,function(){aq()})}})}function T(){document.body.setAttribute("role","application")}function Q(){m.on("keydown",function(ap){if(!V(ap)&&ap.keyCode===o){if(D.isCollapsed()&&D.getRng(true).startOffset===0){var ao=D.getNode().previousSibling;if(ao&&ao.nodeName&&ao.nodeName.toLowerCase()==="table"){ap.preventDefault();return false}}}})}function ad(){if(F()>7){return}W("RespectVisibilityInDesign",true);m.contentStyles.push(".mceHideBrInPre pre br {display: none}");n.addClass(m.getBody(),"mceHideBrInPre");R.addNodeFilter("pre",function(ao){var aq=ao.length,at,ap,au,ar;while(aq--){at=ao[aq].getAll("br");ap=at.length;while(ap--){au=at[ap];ar=au.prev;if(ar&&ar.type===3&&ar.value.charAt(ar.value-1)!="\n"){ar.value+="\n"}else{au.parent.insert(new g("#text",3),au,true).value="\n"}}}});I.addNodeFilter("pre",function(ao){var aq=ao.length,at,ap,au,ar;while(aq--){at=ao[aq].getAll("br");ap=at.length;while(ap--){au=at[ap];ar=au.prev;if(ar&&ar.type==3){ar.value=ar.value.replace(/\r?\n$/,"")}}}})}function s(){n.bind(m.getBody(),"mouseup",function(){var ap,ao=D.getNode();if(ao.nodeName=="IMG"){if((ap=n.getStyle(ao,"width"))){n.setAttrib(ao,"width",ap.replace(/[^0-9%]+/g,""));n.setStyle(ao,"width","")}if((ap=n.getStyle(ao,"height"))){n.setAttrib(ao,"height",ap.replace(/[^0-9%]+/g,""));n.setStyle(ao,"height","")}}})}function ai(){m.on("keydown",function(at){var aq,ap,au,ao,ar;if(V(at)||at.keyCode!=l.BACKSPACE){return}aq=D.getRng();ap=aq.startContainer;au=aq.startOffset;ao=n.getRoot();ar=ap;if(!aq.collapsed||au!==0){return}while(ar&&ar.parentNode&&ar.parentNode.firstChild==ar&&ar.parentNode!=ao){ar=ar.parentNode}if(ar.tagName==="BLOCKQUOTE"){m.formatter.toggle("blockquote",null,ar);aq=n.createRng();aq.setStart(ap,0);aq.setEnd(ap,0);D.setRng(aq)}})}function ah(){function ao(){H();W("StyleWithCSS",false);W("enableInlineTableEditing",false);if(!aj.object_resizing){W("enableObjectResizing",false)}}if(!aj.readonly){m.on("BeforeExecCommand MouseDown",ao)}}function P(){function ao(){af(n.select("a"),function(ar){var ap=ar.parentNode,aq=n.getRoot();if(ap.lastChild===ar){while(ap&&!n.isBlock(ap)){if(ap.parentNode.lastChild!==ap||ap===aq){return}ap=ap.parentNode}n.add(ap,"br",{"data-mce-bogus":1})}})}m.on("SetContent ExecCommand",function(ap){if(ap.type=="setcontent"||ap.command==="mceInsertLink"){ao()}})}function E(){if(aj.forced_root_block){m.on("init",function(){W("DefaultParagraphSeparator",aj.forced_root_block)})}}function u(){m.on("keydown",function(ap){var ao;if(!V(ap)&&ap.keyCode==o){ao=m.getDoc().selection.createRange();if(ao&&ao.item){ap.preventDefault();m.undoManager.beforeChange();n.remove(ao.item(0));m.undoManager.add()}}})}function N(){var ao;if(F()>=10){ao="";af("p div h1 h2 h3 h4 h5 h6".split(" "),function(ap,aq){ao+=(aq>0?",":"")+ap+":empty"});m.contentStyles.push(ao+"{padding-right: 1px !important}")}}function ae(){if(F()<9){R.addNodeFilter("noscript",function(ao){var ap=ao.length,aq,ar;while(ap--){aq=ao[ap];ar=aq.firstChild;if(ar){aq.attr("data-mce-innertext",ar.value)}}});I.addNodeFilter("noscript",function(ao){var ap=ao.length,aq,at,ar;while(ap--){aq=ao[ap];at=ao[ap].firstChild;if(at){at.value=b.decode(at.value)}else{ar=aq.attributes.map["data-mce-innertext"];if(ar){aq.attr("data-mce-innertext",null);at=new g("#text",3);at.value=ar;at.raw=true;aq.append(at)}}}})}}function K(){var av=n.doc,ap=av.body,ar,at,aw;function au(ax,aA){var ay=ap.createTextRange();try{ay.moveToPoint(ax,aA)}catch(az){ay=null}return ay}function aq(ay){var ax;if(ay.button){ax=au(ay.x,ay.y);if(ax){if(ax.compareEndPoints("StartToStart",at)>0){ax.setEndPoint("StartToStart",at)}else{ax.setEndPoint("EndToEnd",at)}ax.select()}}else{ao()}}function ao(){var ax=av.selection.createRange();if(at&&!ax.item&&ax.compareEndPoints("StartToEnd",ax)===0){at.select()}n.unbind(av,"mouseup",ao);n.unbind(av,"mousemove",aq);at=ar=0}av.documentElement.unselectable=true;n.bind(av,"mousedown contextmenu",function(ax){if(ax.target.nodeName==="HTML"){if(ar){ao()}aw=av.documentElement;if(aw.scrollHeight>aw.clientHeight){return}ar=1;at=au(ax.x,ax.y);if(at){n.bind(av,"mouseup",ao);n.bind(av,"mousemove",aq);n.getRoot().focus();at.select()}}})}function ab(){m.on("keyup focusin mouseup",function(ao){if(ao.keyCode!=65||!l.metaKeyPressed(ao)){D.normalize()}},true)}function w(){m.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}function x(){if(!m.inline){m.on("keydown",function(){if(document.activeElement==document.body){m.getWin().focus()}})}}function C(){if(!m.inline){m.contentStyles.push("body {min-height: 150px}");m.on("click",function(ap){var ao;if(ap.target.nodeName=="HTML"){if(h.ie>11){m.getBody().focus();return}ao=m.selection.getRng();m.getBody().focus();m.selection.setRng(ao);m.selection.normalize();m.nodeChanged()}})}}function z(){if(h.mac){m.on("keydown",function(ao){if(l.metaKeyPressed(ao)&&!ao.shiftKey&&(ao.keyCode==37||ao.keyCode==39)){ao.preventDefault();m.selection.getSel().modify("move",ao.keyCode==37?"backward":"forward","lineboundary")}})}}function Y(){W("AutoUrlDetect",false)}function v(){m.on("click",function(ao){var ap=ao.target;do{if(ap.tagName==="A"){ao.preventDefault();return}}while((ap=ap.parentNode))});m.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")}function J(){m.on("init",function(){m.dom.bind(m.getBody(),"submit",function(ao){ao.preventDefault()})})}function aa(){R.addNodeFilter("br",function(ao){var ap=ao.length;while(ap--){if(ao[ap].attr("class")=="Apple-interchange-newline"){ao[ap].remove()}}})}function r(){m.on("dragstart",function(ao){an(ao)});m.on("drop",function(ap){if(!V(ap)){var aq=G(ap);if(aq&&aq.id!=m.id){ap.preventDefault();var ao=f.getCaretRangeFromPoint(ap.x,ap.y,m.getDoc());D.setRng(ao);M(aq.html)}}})}function H(){var ao,ap;if(B()){ao=m.getBody();ap=ao.parentNode;ap.removeChild(ao);ap.appendChild(ao);ao.focus()}}function B(){var ao;if(!q){return 0}ao=m.selection.getSel();return(!ao||!ao.rangeCount||ao.rangeCount===0)}function O(){function ao(at){var ar=new i(at.getBody());var aq=at.selection.getRng();var au=e.fromRangeStart(aq);var ap=e.fromRangeEnd(aq);return !at.selection.isCollapsed()&&!ar.prev(au)&&!ar.next(ap)}m.on("keypress",function(ap){if(!V(ap)&&!D.isCollapsed()&&ap.charCode>31&&!l.metaKeyPressed(ap)){if(ao(m)){ap.preventDefault();m.setContent(String.fromCharCode(ap.charCode));m.selection.select(m.getBody(),true);m.selection.collapse(false);m.nodeChanged()}}});m.on("keydown",function(aq){var ap=aq.keyCode;if(!V(aq)&&(ap==A||ap==o)){if(ao(m)){aq.preventDefault();m.setContent("");m.nodeChanged()}}})}ai();L();if(!h.windowsPhone){ab()}if(ac){O();al();am();t();E();J();Q();aa();if(h.iOS){x();C();v()}else{ak()}}if(y&&h.ie<11){Z();T();ad();s();u();N();ae();K()}if(h.ie>=11){C();Q()}if(h.ie){ak();Y();r()}if(q){O();Z();U();ag();ah();P();w();z();Q()}return{refreshContentEditable:H,isHidden:B}}});