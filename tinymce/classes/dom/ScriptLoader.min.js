define("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(e,a){var c=e.DOM;var d=a.each,b=a.grep;function f(){var h=0,o=1,m=2,p={},n=[],j={},i=[],l=0,k;function g(s,w){var t=c,v,u;function q(){t.remove(u);if(v){v.onreadystatechange=v.onload=v=null}w()}function r(){if(typeof console!=="undefined"&&console.log){console.log("Failed to load: "+s)}}u=t.uniqueId();v=document.createElement("script");v.id=u;v.type="text/javascript";v.src=a._addCacheSuffix(s);if("onreadystatechange" in v){v.onreadystatechange=function(){if(/loaded|complete/.test(v.readyState)){q()}}}else{v.onload=q}v.onerror=r;(document.getElementsByTagName("head")[0]||document.body).appendChild(v)}this.isDone=function(q){return p[q]==m};this.markDone=function(q){p[q]=m};this.add=this.load=function(q,t,r){var s=p[q];if(s==k){n.push(q);p[q]=h}if(t){if(!j[q]){j[q]=[]}j[q].push({func:t,scope:r||this})}};this.remove=function(q){delete p[q];delete j[q]};this.loadQueue=function(r,q){this.loadScripts(n,r,q)};this.loadScripts=function(q,u,t){var s;function r(v){d(j[v],function(w){w.func.call(w.scope)});j[v]=k}i.push({func:u,scope:t||this});s=function(){var v=b(q);q.length=0;d(v,function(w){if(p[w]==m){r(w);return}if(p[w]!=o){p[w]=o;l++;g(w,function(){p[w]=m;l--;r(w);s()})}});if(!l){d(i,function(w){w.func.call(w.scope)});i.length=0}};s()}}f.ScriptLoader=new f();return f});