define("tinymce/caret/CaretBookmark",["tinymce/dom/NodeType","tinymce/dom/DOMUtils","tinymce/util/Fun","tinymce/util/Arr","tinymce/caret/CaretPosition"],function(f,s,e,h,a){var m=f.isText,l=f.isBogus,r=s.nodeIndex;function c(u){var t=u.parentNode;if(l(t)){return c(t)}return t}function i(t){if(!t){return[]}return h.reduce(t.childNodes,function(u,v){if(l(v)&&v.nodeName!="BR"){u=u.concat(i(v))}else{u.push(v)}return u},[])}function j(u,t){while((u=u.previousSibling)){if(!m(u)){break}t+=u.data.length}return t}function n(t){return function(u){return t===u}}function g(w){var t,u,v;t=i(c(w));u=h.findIndex(t,n(w),w);t=t.slice(0,u+1);v=h.reduce(t,function(x,z,y){if(m(z)&&m(t[y-1])){x++}return x},0);t=h.filter(t,f.matchNodeNames(w.nodeName));u=h.findIndex(t,n(w),w);return u-v}function q(u){var t;if(m(u)){t="text()"}else{t=u.nodeName.toLowerCase()}return t+"["+g(u)+"]"}function d(u,w,t){var v=[];for(w=w.parentNode;w!=u;w=w.parentNode){if(t&&t(w)){break}v.push(w)}return v}function k(v,y){var u,A,x=[],t,z,w;u=y.container();A=y.offset();if(m(u)){t=j(u,A)}else{z=u.childNodes;if(A>=z.length){t="after";A=z.length-1}else{t="before"}u=z[A]}x.push(q(u));w=d(v,u);w=h.filter(w,e.negate(f.isBogus));x=x.concat(h.map(w,function(B){return q(B)}));return x.reverse().join("/")+","+t}function o(w,v,u){var t=i(w);t=h.filter(t,function(y,x){return !m(y)||!m(t[x-1])});t=h.filter(t,f.matchNodeNames(v));return t[u]}function b(t,x){var v=t,w=0,u;while(m(v)){u=v.data.length;if(x>=w&&x<=w+u){t=v;x=x-w;break}if(!m(v.nextSibling)){t=v;x=u;break}w+=u;v=v.nextSibling}if(x>t.data.length){x=t.data.length}return new a(t,x)}function p(u,w){var v,t,x;if(!w){return null}v=w.split(",");w=v[0].split("/");x=v.length>1?v[1]:"before";t=h.reduce(w,function(y,z){z=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(z);if(!z){return null}if(z[1]==="text()"){z[1]="#text"}return o(y,z[1],parseInt(z[2],10))},u);if(!t){return null}if(!m(t)){if(x==="after"){x=r(t)+1}else{x=r(t)}return new a(t.parentNode,x)}return b(t,parseInt(x,10))}return{create:k,resolve:p}});